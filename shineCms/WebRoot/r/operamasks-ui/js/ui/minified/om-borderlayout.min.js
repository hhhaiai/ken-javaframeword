(function(a){a.omWidget("om.omBorderLayout",{options:{fit:false,spacing:5},_create:function(){if(!this.options.panels){return}this._minWidth=50;this._minHeight=28;this._buildRegion();this._resizeRegion()},_getRegionSize:function(e){var b=this._getRegion(e),c=this._getRegionProxy(e),d={};d.width=this._regionVisible(b)?b.outerWidth(true):(this._regionVisible(c)?c.outerWidth(true):0);d.height=this._regionVisible(b)?b.outerHeight(true):(this._regionVisible(c)?c.outerHeight(true):0);return d},_resizeRegion:function(){var e=this._getRegion("center"),g=this._getRegion("south"),f=this._getRegion("west"),d=this._getRegion("east"),k=this._getRegionProxy("north"),b=this._getRegionProxy("south"),i=this._getRegionProxy("west"),h=this._getRegionProxy("east"),j=this._getRegionSize("north").height;southHeight=this._getRegionSize("south").height;westWidth=this._getRegionSize("west").width;eastWidth=this._getRegionSize("east").width;layoutWidth=this.element.width();layoutHeight=this.element.height();k&&k.outerWidth(layoutWidth);b&&b.outerWidth(layoutWidth);e.css({top:j,left:westWidth});e.find(">.om-panel-body").omPanel("resize",{width:layoutWidth-westWidth-eastWidth,height:layoutHeight-j-southHeight});var c=e.outerHeight(true);if(g){g.css({top:layoutHeight-g.outerHeight(true)})}if(f){f.css({top:j});f.find(">.om-panel-body").omPanel("resize",{height:c});if(i){i.css({top:j});i.outerHeight(c)}}if(d){d.css({top:j});d.find(">.om-panel-body").omPanel("resize",{height:c});if(h){h.css({top:j});h.outerHeight(c)}}},_regionVisible:function(b){return b&&b.css("display")!="none"},_createRegionProxy:function(e){var c=this;var b='<div class="om-borderlayout-proxy om-borderlayout-proxy-'+e.region+'" proxy="'+e.region+'"><div class="om-panel-title"></div><div class="om-panel-tool"><div class="om-icon panel-tool-expand"></div></div></div>';var d=a(b);d.hover(function(){a(this).toggleClass("om-borderlayout-proxy-hover")}).appendTo(this.element);(function(f){d.find(".panel-tool-expand").hover(function(){a(this).toggleClass("panel-tool-expand-hover")}).click(function(){c.expandRegion(f.region)})})(e)},_buildRegion:function(){var h=this;var c=this.element;this.element.addClass("om-borderlayout");if(this.options.fit){c.css({width:"100%",height:"100%"})}for(var f=0;f<this.options.panels.length;f++){var b=a.extend({},this.options.panels[f]);var j=this.element.find("#"+b.id);if(b.collapsible&&b.region!="center"){this._createRegionProxy(b)}if(b.collapsible){a.extend(b,{collapsible:false,tools:[{iconCls:["panel-tool-collapse","panel-tool-collapse-hover"],handler:function(i){h.collapseRegion(i.element.parent().attr("region"))}}]})}if(b.closable){var d=b.onClose;a.extend(b,{onClose:function(){d&&d.call(j[0]);h._resizeRegion()}})}j.omPanel(b);if(b.region=="north"||b.region=="south"){j.omPanel("resize",{width:c.width()})}var e="0",g=this.options.spacing+"px";if(b.resizable&&b.region!="center"){var k="";handleClass={};if(b.region=="west"){k="e";handleClass.width=g;handleClass.right="-"+g}else{if(b.region=="east"){k="w";handleClass.width=g;handleClass.left="-"+g}else{if(b.region=="south"){k="n";handleClass.height=g;handleClass.top="-"+g}else{if(b.region=="north"){k="s";handleClass.height=g;handleClass.bottom="-"+g}}}}j.parent().resizable({handles:k,helper:"om-borderlayout-resizable-helper-"+k,stop:function(l,i){c.find(">.om-borderlayout-mask").remove();l.element.find(">.om-panel-body").omPanel("resize",l.size);h._resizeRegion()},start:function(o,n){var m=o.element.resizable("option","helper");a("body").find("."+m).css("border-width",h.options.spacing);var p=o.element.attr("region"),l=c.width()-2*h._minWidth,i=c.height()-2*h._minHeight;if(p=="west"){l=c.width()-(h._getRegionSize("east").width+h._minWidth);o.element.resizable("option","maxWidth",l)}else{if(p=="east"){l=c.width()-(h._getRegionSize("west").width+h._minWidth);o.element.resizable("option","maxWidth",l)}else{if(p=="north"){i=c.height()-(h._getRegionSize("south").height+h._minHeight+h.options.spacing);o.element.resizable("option","maxHeight",i)}else{if(p=="south"){i=c.height()-(h._getRegionSize("north").height+h._minHeight+h.options.spacing);o.element.resizable("option","maxHeight",i)}}}}a('<div class="om-borderlayout-mask"></div>').css({width:c.width(),height:c.height()}).appendTo(c)},minWidth:h._minWidth,minHeight:h._minHeight});j.parent().find(".om-resizable-handle").css(handleClass);e=(b.region=="south"?g:0)+" "+(b.region=="west"?g:0)+" "+(b.region=="north"?g:0)+" "+(b.region=="east"?g:0)}j.parent().addClass("om-borderlayout-region").addClass("om-borderlayout-region-"+b.region).css("margin",e).attr("region",b.region);j.prev().addClass("om-borderlayout-region-header")}},_getRegion:function(c){var b=this.element.find('>[region="'+c+'"]');return b.size()>0?b:false},_getRegionProxy:function(b){var c=this.element.find('>[proxy="'+b+'"]');return c.size()>0?c:false},_getPanelOpts:function(c){for(var b=0;b<this.options.panels.length;b++){if(c==this.options.panels[b].region){return this.options.panels[b]}}return false},collapseRegion:function(d){var c=this._getPanelOpts(d);if(!c||!c.collapsible){return}var b=this._getRegion(d);$body=b.find(">.om-panel-body");if(b){var e=a.data($body[0],"omPanel");if(e.options.closed){return}if(c.onBeforeCollapse&&e._trigger("onBeforeCollapse")===false){return false}b.hide();c.onCollapse&&e._trigger("onCollapse");this._getRegionProxy(d).show();this._resizeRegion()}},expandRegion:function(d){var c=this._getPanelOpts(d);if(!c||!c.collapsible){return}var b=this._getRegion(d);$body=b.find(">.om-panel-body");if(b){var e=a.data($body[0],"omPanel");if(e.options.closed){return}if(c.onBeforeExpand&&e._trigger("onBeforeExpand")===false){return false}b.show();c.onExpand&&e._trigger("onExpand");this._getRegionProxy(d).hide();this._resizeRegion()}},closeRegion:function(d){var c=this._getPanelOpts(d);if(!c||!c.closable){return}var b=this._getRegion(d);$body=b.find(">.om-panel-body");if(b){var e=a.data($body[0],"omPanel");if(e.options.closed){return}b.find(">.om-panel-body").omPanel("close");this._getRegionProxy(d).hide();this._resizeRegion()}},openRegion:function(d){var c=this._getPanelOpts(d);if(!c||!c.closable){return}var b=this._getRegion(d);$body=b.find(">.om-panel-body");if(b){var e=a.data($body[0],"omPanel");if(!e.options.closed){return}b.find(">.om-panel-body").omPanel("open");this._getRegionProxy(d).hide();this._resizeRegion()}}})})(jQuery);